# 用户指南 - Fiction CMS

本综合指南解释了如何使用 Fiction CMS 管理多个静态站点的内容。无论您是内容管理员、编辑者还是站点管理员，本指南都将帮助您充分利用 Fiction CMS。

## 目录

- [开始使用](#开始使用)
- [身份认证和用户管理](#身份认证和用户管理)
- [站点管理](#站点管理)
- [内容编辑](#内容编辑)
- [文件管理](#文件管理)
- [高级功能](#高级功能)
- [故障排除](#故障排除)

## 开始使用

### 首次登录

1. **访问 Fiction CMS** 在您的部署 URL（例如：`https://your-cms.domain.com`）

2. **使用默认凭据登录**：
   - 用户名: `admin`
   - 密码: `admin123`

3. **首次登录后立即更改默认密码**：
   - 前往 **设置** → **个人资料**
   - 点击 **更改密码**
   - 输入安全密码

### 仪表板概览

登录后，您将看到主仪表板，包括：

- **站点概览**: 快速访问您管理的站点
- **最近活动**: 最新的内容更改和部署
- **快速操作**: 创建新站点、管理用户、系统设置
- **系统状态**: 健康指标和部署状态

## 身份认证和用户管理

### 用户角色

Fiction CMS 支持基于角色的访问控制：

#### 管理员

- **完整系统访问权限**: 管理所有站点、用户和系统设置
- **用户管理**: 创建、修改和删除用户账户
- **站点创建**: 创建和配置新站点
- **系统配置**: 修改全局设置和权限

#### 编辑者

- **内容管理**: 编辑分配站点的内容
- **文件操作**: 创建、修改和删除内容文件
- **站点访问**: 访问分配给他们的站点
- **预览更改**: 在发布前使用预览模式

#### 查看者

- **只读访问**: 查看内容和站点信息
- **浏览文件**: 导航文件结构而不进行编辑
- **查看历史**: 查看更改历史和提交日志

### 管理用户账户

**对于管理员：**

1. **创建新用户**：
   - 前往 **设置** → **用户**
   - 点击 **添加用户**
   - 填写用户详细信息（用户名、邮箱、密码）
   - 分配适当的角色
   - 选择站点权限

2. **修改现有用户**：
   - 在用户列表中找到用户
   - 点击 **编辑** 修改详细信息
   - 调整角色分配和站点权限
   - 保存更改

3. **站点访问管理**：
   - 将用户分配到特定站点
   - 设置每个站点的权限级别
   - 根据需要移除访问权限

## 站点管理

### 理解站点

在 Fiction CMS 中，"站点"代表包含静态网站的 GitHub 仓库。每个站点可以有：

- **仓库 URL**: GitHub 仓库位置
- **本地路径**: 用于文件管理的服务器位置
- **构建配置**: 构建站点的命令和设置
- **可编辑路径**: 可通过 CMS 修改的目录
- **SQLite 数据库**: 可通过界面编辑的数据库文件

### 创建新站点

**先决条件：**

- 包含静态站点内容的 GitHub 仓库
- 具有仓库权限的 GitHub 个人访问令牌 (PAT)
- Fiction CMS 中的管理员角色

**步骤：**

1. **导航到站点**: 在主导航中点击 **站点**

2. **创建新站点**: 点击 **创建新站点** 按钮

3. **基本配置**：
   - **站点名称**: 选择描述性名称
   - **仓库 URL**: GitHub 仓库的完整 HTTPS URL
   - **描述**: 站点的简要描述

4. **GitHub 配置**：
   - **GitHub PAT**: 仓库访问的个人访问令牌
   - **本地路径**: 克隆的服务器路径（如果为空则自动生成）

5. **构建配置**：
   - **构建命令**: 构建站点的命令（例如：`npm run build`）
   - **构建输出目录**: 放置构建文件的位置（例如：`dist`、`_site`）

6. **内容配置**：
   - **可编辑路径**: 可编辑目录的逗号分隔列表
     - 示例：`content/, data/, posts/`
   - **SQLite 文件**: 通过界面可编辑的数据库文件

7. **保存配置**: 点击 **创建站点** 保存并初始化

### 站点配置示例

#### Hugo 博客站点

```
站点名称: My Hugo Blog
仓库 URL: https://github.com/username/hugo-blog
构建命令: hugo
构建输出目录: public
可编辑路径: content/, data/, static/
SQLite 文件: data/blog.db (如果使用数据库内容)
```

#### Next.js 文档站点

```
站点名称: Project Documentation  
仓库 URL: https://github.com/company/docs-site
构建命令: npm run build
构建输出目录: out
可编辑路径: content/, public/images/
SQLite 文件: (无)
```

#### Jekyll 作品集

```
站点名称: Designer Portfolio
仓库 URL: https://github.com/designer/portfolio
构建命令: bundle exec jekyll build
构建输出目录: _site  
可编辑路径: _posts/, _data/, assets/
SQLite 文件: _data/portfolio.db
```

## 内容编辑

### 文件浏览器

文件浏览器提供了您站点内容的组织化视图：

**功能：**

- **搜索文件**: 使用搜索框按名称过滤文件
- **文件类型过滤器**: 仅显示特定类型（Markdown、JSON、SQLite、资源）
- **文件图标**: 不同文件类型的视觉指示器
- **文件信息**: 显示文件大小和修改日期
- **文件夹导航**: 展开/折叠目录

**文件类型图标：**

- 📝 Markdown 文件 (`.md`、`.mdx`)
- 📊 JSON 文件 (`.json`)  
- 🗃️ SQLite 数据库 (`.db`、`.sqlite`)
- 🖼️ 图像 (`.png`、`.jpg`、`.gif` 等)
- 📄 其他文本文件

### Markdown 编辑器

Markdown 编辑器提供丰富的编辑体验和实时预览：

**功能：**

- **双模式**: 在编辑和预览模式之间切换
- **实时预览**: 输入时实时渲染
- **语法高亮**: 编辑模式下的 Markdown 语法高亮
- **自动完成**: Markdown 语法的智能建议
- **图像支持**: 预览嵌入的图像
- **表格编辑**: 增强的表格编辑体验

**Markdown 编辑技巧：**

- 使用 `# 标题` 作为标题（最多 6 级）
- `**粗体**` 和 `*斜体*` 用于强调
- 用 `[文本](url)` 创建链接
- 用 `![alt text](image-url)` 添加图像
- 对于内联代码使用 \`code\`，对于代码块使用 \`\`\`language
- 用管道符号创建表格：`| 列1 | 列2 |`

### JSON 编辑器

JSON 编辑器支持标准 JSON 和 JSON5（扩展 JSON）：

**功能：**

- **实时验证**: 语法错误的即时反馈
- **格式支持**: 在 JSON 和 JSON5 模式之间切换
- **自动格式化**: 自动缩进和格式化
- **错误高亮**: 语法问题的视觉指示器
- **验证阻止**: 防止保存无效的 JSON

**JSON5 增强功能：**

- 允许注释（`// 单行` 和 `/* 多行 */`）
- 允许尾随逗号
- 无引号的对象键（当为有效标识符时）
- 使用反斜杠的多行字符串

**JSON5 示例：**

```json5
{
  // 站点配置
  title: "My Website",
  description: "A sample site",
  features: [
    "responsive design",
    "fast loading", // 尾随逗号可以
  ],
  /* 
   多行注释
   包含配置说明
  */
  buildSettings: {
    minify: true,
    sourceMaps: false,
  }
}
```

### 代码编辑器

对于其他文件类型，Fiction CMS 提供语法高亮的代码编辑：

**支持的语言：**

- JavaScript/TypeScript (`.js`、`.ts`、`.jsx`、`.tsx`)
- CSS/SCSS/LESS (`.css`、`.scss`、`.less`)
- HTML/XML (`.html`、`.xml`、`.svg`)
- YAML (`.yml`、`.yaml`)  
- SQL (`.sql`)
- Python (`.py`)
- Shell 脚本 (`.sh`、`.bash`)

**编辑器功能：**

- 行号
- 代码折叠
- 查找和替换 (Ctrl/Cmd + F)
- 自动完成
- 错误检测（对于支持的语言）

### SQLite 数据库编辑器

对于 SQLite 数据库文件，Fiction CMS 提供基于表格的编辑界面：

**当前功能：**

- **表格列表**: 查看数据库中的所有表格
- **数据查看**: 分页浏览表格内容
- **行创建**: 通过表单添加新行

**即将推出的功能：**

- 可视化表格编辑器
- 高级查询
- 数据导出/导入
- 架构修改

## 文件管理

### 文件操作

**创建文件：**

1. 在文件浏览器中导航到所需目录
2. 右键点击空白区域或使用 **新建文件** 按钮
3. 输入适当扩展名的文件名
4. 选择文件类型（确定编辑器模式）
5. 在适当的编辑器中开始编辑

**删除文件：**

1. 在浏览器中右键点击文件
2. 选择 **删除文件**
3. 在模态对话框中确认删除
4. 文件被移除，更改提交到 Git

**移动/重命名文件：**

1. 右键点击文件
2. 选择 **重命名** 或 **移动**
3. 输入新名称或路径
4. 确认更改

### Git 集成

Fiction CMS 中的每个保存操作都会创建一个 Git 提交：

**自动 Git 操作：**

- **自动提交**: 每次文件保存都创建一个提交
- **提交消息**: 可选的自定义提交消息
- **作者归属**: 使用认证用户的信息
- **自动推送**: 更改推送到 GitHub 仓库

**提交消息指南：**

- 描述性地说明所做的更改
- 使用现在时态（"Add new blog post" 而不是 "Added new blog post"）
- 如果适用，引用相关问题或票据
- 保持消息简洁但信息丰富

**好的提交消息示例：**

- "Update homepage content for summer campaign"
- "Add new product images to gallery"
- "Fix typos in about page"
- "Update site navigation menu structure"

## 高级功能

### 搜索和替换

**全局搜索：**

- 使用 Ctrl/Cmd + Shift + F 进行跨文件全局搜索
- 搜索支持正则表达式
- 按文件类型过滤结果
- 跨多个文件替换

**文件特定搜索：**

- 在单个文件中使用 Ctrl/Cmd + F
- 支持区分大小写和正则表达式搜索
- 使用 F3/Shift+F3 在匹配之间导航

### 键盘快捷键

**常规导航：**

- `Ctrl/Cmd + S`: 保存当前文件
- `Ctrl/Cmd + F`: 在当前文件中查找  
- `Ctrl/Cmd + Shift + F`: 全局搜索
- `Ctrl/Cmd + Z`: 撤销
- `Ctrl/Cmd + Y`: 重做

**编辑器特定：**

- `Ctrl/Cmd + D`: 选择下一个出现
- `Alt + Up/Down`: 上下移动行
- `Shift + Alt + Down`: 复制行
- `Ctrl/Cmd + /`: 切换注释

### 预览和暂存

**预览模式：**

- 在 Markdown 编辑器中切换到预览模式
- 看到内容将如何显示
- 测试链接和嵌入内容
- 检查格式和布局

**暂存工作流：**

- 保存更改提交到仓库
- 更改自动触发构建（如果配置）
- 使用 GitHub Pages 进行暂存预览
- 在公开之前审查更改

## 故障排除

### 常见问题

**问题："身份认证失败"错误**

- **解决方案**: 检查您的会话是否已过期。退出并重新登录。
- **预防**: 保持浏览器标签页活跃或在需要时重新登录。

**问题: 文件无法保存**  

- **解决方案**: 检查文件权限和 Git 仓库访问。
- **检查**: 确保您的 GitHub PAT 对仓库有写权限。

**问题: 预览不更新**

- **解决方案**: 刷新预览面板或在编辑/预览模式之间切换。
- **检查**: 确保 Markdown 中没有语法错误。

**问题: JSON 验证错误**

- **解决方案**: 检查缺少的逗号、引号或括号。
- **提示**: 如果需要注释或尾随逗号，切换到 JSON5 模式。

**问题: 看不到某些文件**

- **解决方案**: 检查文件路径是否包含在站点的可编辑路径配置中。
- **管理员**: 站点管理员可以在站点设置中修改可编辑路径。

### 获取帮助

1. **检查错误消息**: 仔细阅读错误消息以获取具体指导
2. **浏览器控制台**: 打开浏览器开发者工具 (F12) 查看详细错误  
3. **联系管理员**: 向您的 Fiction CMS 管理员报告问题
4. **文档**: 参考本指南的具体部分获取详细帮助

### 浏览器要求

**支持的浏览器：**

- Chrome 90+（推荐）
- Firefox 88+
- Safari 14+
- Edge 90+

**必需功能：**

- 启用 JavaScript
- LocalStorage 支持
- 现代 ES6+ 功能
- WebSocket 支持（用于未来的实时功能）

---

本用户指南涵盖了 Fiction CMS 的基本功能。有关更高级的主题、管理员指南或技术文档，请参考文档的其他部分。
